

local controller = require(ReplicatedStorage.WaitForChild("Controllers"):WaitForChild("ItemTradingController"))
local fungsiOriginal = controller.CreateTradePrompt
local Replion, Promise, ItemUtility, ItemStringUtility, PromptController
local moduleAccept = pcall(function()
    Replion = require(replicatedStorage:WaitForChild("Packages"):WaitForChild("Replion"))
    Promise = require(replicatedStorage:WaitForChild("Packages"):WaitForChild("Promise"))
    ItemUtility = require(replicatedStorage:WaitForChild("Shared"):WaitForChild("ItemUtility"))
    ItemStringUtility = require(replicatedStorage:WaitForChild("Modules"):WaitForChild("ItemStringUtility"))
    PromptController = require(replicatedStorage:WaitForChild("Controllers"):WaitForChild("PromptController"))
end)
 
local oldItemTradingController
local AutoAcceptTrade
 AutoAcceptTrade  = PlayerSetTab:CreateToggle({
    Name = "Auto Accept Prompt Trade",
    CurrentValue = false,
    Flag = "AutoAcceptTrade",
    Callback = function(value)
 
        if value then
            -- Aktifkan auto accept (tanpa prompt)
              if moduleAccept and PromptController and Promise then
                if not oldItemTradingController then
                    oldItemTradingController = hookfunction(PromptController.FirePrompt, function(self, promptText, ...)
                        if type(promptText) == "string" and promptText:find("Accept") and promptText:find("from:") or  promptText:find("to give") then
                            return Promise.resolve(true)
                        end
                        return oldItemTradingController(self, promptText, ...)
                    end)
                end
            end

            Rayfield:Notify({
                Title = "Auto Accept Trade",
                Content = "✅ Trade otomatis aktif.",
                Duration = 1
            })
        else
            -- Kembalikan fungsi ke normal (dengan prompt)
            if oldItemTradingController then
                hookfunction(PromptController.FirePrompt, oldItemTradingController)
                oldItemTradingController = nil
            end
            Rayfield:Notify({
                Title = " Auto Accept Trade",
                Content = "❌Trade manual.",
                Duration = 1
            })
        end
    end
}) 

 
getgenv().oldAFKScript = hookmetamethod(game, "__namecall", newcclosure(function(self, ...)
    local method = getnamecallmethod()

     if method == "FireServer" and tostring(self) == "ReconnectPlayer" then 
        return nil  
    end

    return getgenv().oldAFKScript(self, ...)
end))
